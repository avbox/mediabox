#
# Makefile
#
# Author: Fernando Rodriguez
# Email: frodriguez.developer@outlook.com
# 
# Copyright 2014-2015 Fernando Rodriguez
# All rights reserved.
# 
# This code is distributed for educational purposes
# only. It may not be distributed without written 
# permission from the author.
# 

ECHOFLAGS=-e
PREFIX=@prefix@

ifneq ($(shell echo -e "Hello"),Hello)
	ECHOFLAGS=
endif

CC=@CC@
CFLAGS=@CFLAGS@
LDFLAGS=@LDFLAGS@
CFLAGS+=-std=gnu99 -fno-stack-protector -Wunused-variable -Wall -D_GNU_SOURCE
ASFLAGS=-ggdb
LDFLAGS+=-lz -lm


SOURCES=main.o \
	video.o \
	video-directfb.o \
	input.o \
	input-directfb.o \
	input-socket.o \
	input-tcp.o \
	input-bluetooth.o \
	pipe_util.o \
	player.o \
	shell.o \
	su.o \
	ui-textview.o \
	ui-menu.o \
	ui-progressbar.o \
	mainmenu.o \
	downloads.o \
	downloads-backend.o \
	mediasearch.o \
	url_util.o \
	time_util.o \
	file_util.o \
	string_util.o \
	about.o \
	announce.o \
	iface_util.o \
	library-backend.o \
	library.o \
	timers.o \
	alsa-volume.o \
	process.o

all: mediabox

clean: 
	$(RM) *.o 
	$(RM) mediabox

mediabox: $(SOURCES)
	$(CC) $(LDFLAGS) -o mediabox $(SOURCES)

.s.o:
	$(AS) $(ASFLAGS) -c $< -o $@

.c.o:
	$(CC) $(CFLAGS) -c $< -o $@

install:
	mkdir -p $(PREFIX)/bin
	mkdir -p $(PREFIX)/share/mediabox
	cp mediabox $(PREFIX)/bin/mediabox
	cp res/mediatomb/config.xml $(PREFIX)/share/mediabox/mediatomb-config.xml
	cp res/deluge/core.conf $(PREFIX)/share/mediabox/deluge-core.conf
	cp res/deluge/auth $(PREFIX)/share/mediabox/deluge-auth

